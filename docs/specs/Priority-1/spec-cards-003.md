# spec-cards-003 — 카드 운영 PRD

## 1. 개요
- 업무 단위를 나타내는 카드를 생성·편집·이동·아카이브하는 전 과정을 정의한다.
- 카드 정보 구조를 통일해 백엔드 데이터와 프론트 UI가 일관되게 동작하도록 한다.

## 2. 연계 요구사항
- FR-05 카드 생성
- FR-06 카드 이동
- FR-07 카드 편집
- FR-08 카드 삭제/아카이브

## 3. 사용자 시나리오
1. 팀원이 새로운 업무를 등록하면서 제목, 설명, 담당자, 마감일, 라벨을 지정한다.
2. 진행 상황에 따라 카드를 다른 컬럼으로 끌어다 놓는다.
3. 카드 상세 패널에서 정보를 수정하고 댓글을 남긴다.
4. 완료된 카드를 아카이브하여 보드를 깔끔하게 유지한다.

## 4. 디자인 가이드라인
- 기본 카드 뷰: 제목, 담당자 아바타, 라벨 배지, 마감 D-Day를 표시한다.
- 상태별 시각 피드백: 긴급 카드(기한 초과)는 파스텔 핑크 테두리, 완료 예정 카드는 파스텔 민트 배지를 사용한다.
- 카드 생성/편집은 동일 양식(모달/패널)으로 제공하고, 필드 그룹을 “기본 정보 / 추가 정보 / 협업”으로 나눈다.
- 아카이브된 카드는 별도 리스트나 필터로 확인 가능해야 한다.

## 5. 프론트엔드 규격
- **컴포넌트**
  - `CardItem`: 기본 카드 UI, 클릭 시 상세 패널 오픈.
  - `CardDetailPanel`: 정보 탭(설명, 첨부, 라벨), 활동 탭(댓글, 히스토리)을 탭으로 분리.
  - `CardForm`: 생성·편집 공용 폼, 제목 필수, 설명/라벨/담당자 선택 입력.
- **상호작용**
  - 드래그앤드롭 이동 시 낙관적 업데이트 후 실패 시 원위치.
  - 마감일 설정 시 달력 팝오버, 타임존은 브라우저 기준으로 표시.
  - 아카이브/삭제 버튼 클릭 시 확인 다이얼로그 + 토스트 피드백.
- **상태 처리**
  - React Query 또는 상태 관리자에서 카드별 캐시 키를 정의하고, 상세 패널에서 수정 후 리스트 캐시를 무효화한다.
  - 아카이브 필터 적용 시 카드 리스트에서 해당 카드 숨김 처리.

## 6. 백엔드 규격
- **엔드포인트**
  - `POST /api/v1/boards/{boardId}/cards`
  - `PATCH /api/v1/cards/{cardId}`
  - `POST /api/v1/cards/{cardId}/move` (목표 보드/컬럼, 순서 인덱스 포함)
  - `POST /api/v1/cards/{cardId}/archive`
  - `DELETE /api/v1/cards/{cardId}` (영구 삭제)
- **데이터 필드**
  - 제목(1~120자), 설명(5000자), 담당자 ID(선택), 라벨 배열, 우선순위 값(L/M/H), 마감일(ISO datetime).
  - 이동 기록 테이블을 별도로 유지하여 카드 이동 히스토리와 활동 로그를 연계한다.
- **비즈니스 규칙**
  - 카드 이동 시 동일 컬럼 내 순서 재조정 및 목표 컬럼 순서 삽입 로직 필요.
  - 아카이브 상태에서만 영구 삭제 가능하도록 제한한다.

## 7. 수용 기준
1. 새 카드 생성 후 해당 컬럼 상단(또는 설정된 기본 위치)에 즉시 표시된다.
2. 카드 이동 후 활동 로그에 “컬럼 A → 컬럼 B” 기록이 남는다.
3. 카드 상세 편집 시 실시간 자동 저장 또는 저장 버튼을 제공하며, 저장 성공 시 패널 상단에 체크 표시가 나타난다.
4. 아카이브된 카드는 기본 보드 뷰에서 숨겨지고 “아카이브 보기”에서만 확인된다.

## 8. 구현 순서
1. 백엔드: 카드 엔티티, 이동/아카이브 API, 히스토리 로깅.
2. 프론트엔드: 카드 리스트/아이템 + 상세 패널, 드래그앤드롭 연동.
3. UX 향상: 라벨 색상 선택기, 마감일 피커, 아카이브 관리 화면.
